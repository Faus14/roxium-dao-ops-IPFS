import { InvalidMessageError } from '@libp2p/interface';
export function validateOpaqueData(opaque, hostname, tokenTTL) {
    if (opaque.hostname !== hostname) {
        throw new InvalidMessageError('Invalid hostname');
    }
    // verify signature
    if (opaque.challengeClient == null) {
        throw new InvalidMessageError('Missing challenge-client');
    }
    if (Date.now() - opaque.creationTime > tokenTTL) {
        throw new InvalidMessageError('Token expired');
    }
}
//# sourceMappingURL=validation.js.map